@using System.Net.Http
@using System.Net.Http.Json
@using System.Text.Json
@using LMS.Shared.Dtos
@using Microsoft.AspNetCore.Authorization
@page "/studentoverview/{UserId}"
@inject HttpClient Http

@if (applicationUser == null)
{
    <p>Loading...</p>
}
else
{
    <div class="card custom-card custom-shadow mb-3">
        <div class="card-header custom-card-header">User Information</div>
        <div class="card-body custom-card-body">
            <h5 class="card-title">@applicationUser.FullName</h5>
            <p class="card-text">Email: @applicationUser.Email</p>
        </div>
    </div>

    <div>
        <h4>Course Participants:</h4>
        <ul class="list-group">
            @foreach (var participant in applicationUser.CourseParticipants)
            {
                <li class="list-group-item">@participant.FullName - @participant.Email</li>
            }
        </ul>
    </div>

    <div>
        <h4>Modules:</h4>
        @foreach (var module in applicationUser.Modules)
        {
            <div class="card mb-2">
                <div class="card-body">
                    <h5 class="card-title">@module.Name</h5>
                    <p class="card-text">@module.Description</p>
                    <p class="card-text">Start: @module.StartDate.ToShortDateString() - End: @module.EndDate.ToShortDateString()</p>
                </div>
            </div>
        }
    </div>
}

@code {
    [Parameter]
    public string UserId { get; set; }

    private ApplicationUserDTO applicationUser;

    protected override async Task OnInitializedAsync()
    {
        applicationUser = await Http.GetFromJsonAsync<ApplicationUserDTO>($"https://localhost:7050/api/ApplicationUser/{UserId}");
    }
}