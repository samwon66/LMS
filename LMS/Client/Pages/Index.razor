@page "/"
@using System.Net.Http
@using System.Net.Http.Json
@using System.Text.Json


<PageTitle>Index</PageTitle>

<h1>LMS</h1>

Welcome to LMS.


<AuthorizeView Roles="Teacher">
    <Authorized >
        <h5>Hi Teacher: @context.User.Identity?.Name!</h5><br />
        <h6>You are signed in as Teacher!</h6>
    </Authorized>
</AuthorizeView>


<AuthorizeView Roles="Student">
    <Authorized>
        <h5>Hi Student: @context.User.Identity?.Name!</h5><br />
        <h6>You are signed in as student!</h6>
    </Authorized>
</AuthorizeView>

<AuthorizeView>
    <NotAuthorized>
        <h6>You are visitor!</h6>
    </NotAuthorized>
</AuthorizeView>


@code {
    private UserDTO user;
    public string UserId { get; set; }

    protected async Task OnIntializedAsync()
    {
        try
        {
            if (Guid.TryParse(UserId, out Guid userIdGuid))
            {
                var httpClient = new HttpClient();
                user = await httpClient.GetFromJsonAsync<UserDTO>($"https://localhost:7050/api/user/{userIdGuid}");
            }
            else
            {
                Console.WriteLine($"Error: Invalid User ID specified in the URL - {UserId}");
                user = null;
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Error: {ex.Message}");
            user = null;
        }
    }
}